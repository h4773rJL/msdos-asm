INCLUDE PERSA.BIB
.MODEL MEDIUM
.STACK
.DATA
Q_PASS  DB      'rauldelrio',0
ASKMSG  DB      'INTRODUSCA CONTRASE¥A:',0AH,0DH,'$'
OKMSG   DB      'CONTRASE¥A CORRECTA',0AH,0DH,'$'
WRONMS  DB      'CONTRASE¥A INCORRECTA',0AH,0DH,'$'

.CODE
INI:    MOV AX,@DATA
        MOV DS,AX
        CLD
        CLS
        WRITE ASKMSG
        ADD 	SP,4 ;LIMPIA PILA
	PUSH 	CS
	MOV 	AX,OFFSET Q_PASS
	PUSH 	AX
	CALL	GETPASSWORD
	MOV 	DX,OFFSET OKMSG
	OR	AX,AX
	JE 	MAIN_2
	MOV 	DX,OFFSET WRONMS
MAIN_2:	PUSH 	AX
	MOV 	AH,09
	INT 	21H
	POP	AX
	MOV	AH,4CH
	INT 	21H

;INICIO DE PROCEDIMIENTOS
;PROGRAM BY PERSA 

GETPASSWORD PROC NEAR
	PUSH 	BP
	MOV 	BP,SP
	PUSH	BX
	PUSH	DX
	PUSH	DI
	PUSH	ES
	MOV 	DI,SS:[BP+6]
	MOV 	ES,DI
	MOV 	DI,SS:[BP+4]
	XOR	BX,BX
GETP_1:	MOV 	AH,07
	INT 	21H
	OR 	AL,AL
	
        JNE     GETP_2
	MOV 	AH,07
	INT 	21H
	MOV 	AL,1
GETP_2:	CMP 	AL,13
	JE	GETP_3
	SUB 	AL,ES:[DI]
	OR 	BL,AL
        CMP     BYTE PTR ES:[DI],0
	JE 	GETP_1
	INC 	DI
	JMP	SHORT GETP_1
GETP_3:	OR	BL,ES:[DI]
        MOV     AX,BX
	POP 	ES
	POP	DI
	POP	DX
	POP	BX
	MOV	SP,BP
	POP	BP
	RET

GETPASSWORD ENDP
END INI
	
